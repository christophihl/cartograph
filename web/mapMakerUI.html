<html xmlns="http://www.w3.org/1999/html">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The Map of World Knowledge</title>

    <meta property="og:title" content="Cartograph: IUI 2017" />
    <link rel="shortcut icon" type="image/x-icon" href="images/cartographIcon.png" />

    <link rel="stylesheet" type="text/css" href="css/reset.css" />
    <link rel="stylesheet" type="text/css" href="css/leaflet.css" />
    <link rel="stylesheet" type="text/css" href="css/auto-complete.css"/>
    <link rel="stylesheet" type="text/css" href="css/tooltipster.bundle.min.css" />
    <link rel="stylesheet" type="text/css" href="css/tooltipster.shadow.min.css" />
    <link rel="stylesheet" type="text/css" href="css/pace.css"  />
    <link rel="stylesheet" type="text/css" href="css/mapMakerUI.css" />

    <script src="js/pace.min.js"></script>
    <script src="js/jquery.min.js"></script>
    <script src="js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="js/tooltipster.bundle.min.js"></script>
    <script src="js/js.cookie.js"></script>

    <!-- leaflet -->
    <script src="js/leaflet.js"></script>
    <script src="js/carto-hash.js"></script>
    <script src="js/carto-log.js"></script>
    <script src="js/leaflet.curve.js"></script>

    <script src="js/mingle/kdtree.js"></script>
    <script src="js/mingle/philogl.js"></script>
    <script src="js/mingle/graph.js"></script>
    <script src="js/mingle/mingle.js"></script>

    <!-- Main tangram library -->
    <script src="js/tangram.min.js"></script>
    <script src="js/tinycolor.js"></script>

    <!-- -->
    <script src="js/cartograph.js"></script>
    <script src="js/cartographedges.js"></script>

  </head>

  <body>
    <div id="tooltip">&nbsp;</div>
    <div id="map"></div>
    <div id="search">
        <input id="search-field" type="text" placeholder="Search the map">
    </div>

    <div id="related-label">
      showing concepts related to "<span>foo</span>" <a href="#">(hide)</a>
    </div>
    <div id="map-choice">
      <div layerId="home" class="home-choice"><a href="index.html"><img src="images/home-7-128.png"></a></div>
      <div layerId="wmf_en-cluster" class="choice">Wikipedia topics</div>
      <div layerId="movies_nav-cluster" class="choice">Movie groups</div>
    </div>

    <div class="legend" id="legend-wmf_en-cluster">
      <h1>Map of Wikipedia Topics</h1>
      <p>
        This map visualizes Wikipedia articles.
        Cities represent articles, with neighboring cities being related in meaning.
        Colored countries correspond to groups of related articles.
      </p>
    </div>

    <div class="legend" id="legend-companies_nav-cluster">
      <h1>Map of Company Groups</h1>
      <p>
        This map visualizes companies.
        Each city represents a companies, with neighboring cities being related in meaning.
        Colored countries correspond to groups of related companies.
      </p>
    </div>

    <script>
      var showLayerUI = function(layerId) {
          var choices = $("#map-choice .choice");
          $(choices).removeClass("active");
          $(choices).filter('[layerId=\'' + layerId + '\']').addClass('active');
          $("div.legend").hide();
          $("#legend-" + layerId).show();
      };

      var oldParts = window.location.href.split('#')[0].split('/');
      var oldMap = oldParts[oldParts.length - 3];
      console.log('oldMap', oldMap, oldParts);

      var choices = $("#map-choice .choice");
      choices.on('click', function() {
                var layerId = $(this).attr('layerId');
                var newParts = layerId.split('-');
                var newMap = newParts[0];
                var newLayer = newParts[1];
                if (newMap == oldMap) {
                console.log(newLayer, '1');
                  showLayerUI(layerId);
                  CG.changeLayer(newLayer);
                } else {
                  var oldUrl = window.location.href.split('#')[0];
                  var newUrl = oldUrl.replace(oldMap, newMap) + '#' + newLayer + '/4/0.00/0.00';
                  console.log('newUrl', newUrl);
                  location.href = newUrl;
                }
                return false;
              });

      var layer = 'cluster';
      if (window.location.hash) {
        var l = L.Hash.parseHash(window.location.hash);
        if (l && l.layer) {
          layer = l.layer;
        }
        CG.init(l.layer);
        CG.map.setView(l.center, l.zoom);
      } else {
        CG.init(layer);
        CG.map.setView([0, 0], 4);
      }
      showLayerUI(oldMap + '-' + layer);
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61924569-2', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>
